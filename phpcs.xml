<?xml version="1.0"?>
<ruleset name="Planet4 Coding Standards">
  <description>Generally-applicable sniffs for Planet4</description>

  <!-- Show sniffs, progress -->
  <arg value="sp"/>
  <arg name="extensions" value="php"/>
  <arg name="tab-width" value="4"/>
  <config name="encoding" value="utf-8"/>

  <rule ref="PSR12"/>

  <rule ref="WordPress-Docs">
    <exclude name="Squiz.Commenting.FileComment.Missing"/>
    <exclude name="Squiz.Commenting.FileComment.MissingPackageTag"/>
    <exclude name="Generic.Commenting.DocComment.MissingShort"/>
    <exclude name="Squiz.Commenting.FunctionComment.SpacingAfterParamType"/>
  </rule>

  <!-- Deprecated WP features -->
  <config name="minimum_supported_wp_version" value="5.4"/>
  <rule ref="WordPress.WP.DeprecatedFunctions"/>
	<rule ref="WordPress.WP.DeprecatedClasses"/>
	<rule ref="WordPress.WP.DeprecatedParameters"/>
	<rule ref="WordPress.WP.DeprecatedParameterValues"/>

  <!-- Add rule for theme's textdomains -->
  <rule ref="WordPress.WP.I18n">
    <properties>
      <property name="text_domain" type="array" value="planet4-master-theme,planet4-master-theme-backend"/>
    </properties>
  </rule>

  <!-- Using tabs for WP interactions sake -->
  <rule ref="Generic.WhiteSpace.DisallowSpaceIndent"/>
  <rule ref="Generic.WhiteSpace.DisallowTabIndent">
    <exclude name="Generic.WhiteSpace.DisallowTabIndent.TabsUsed"/>
  </rule>

  <rule ref="Generic.Files.LineLength">
    <properties>
      <property name="lineLimit" value="80"/>
      <property name="absoluteLineLimit" value="120"/>
    </properties>
  </rule>

  <rule ref="Generic.PHP.CharacterBeforePHPOpeningTag"/>
  <rule ref="Generic.PHP.DeprecatedFunctions"/>

  <!-- Slevomat Coding Standard -->
  <!-- # Functional -->
  <rule ref="SlevomatCodingStandard.TypeHints">
    <exclude name="SlevomatCodingStandard.TypeHints.PropertyTypeHint.MissingTraversableTypeHintSpecification"/>
    <exclude name="SlevomatCodingStandard.TypeHints.ParameterTypeHint.MissingTraversableTypeHintSpecification"/>
    <exclude name="SlevomatCodingStandard.TypeHints.ReturnTypeHint.MissingTraversableTypeHintSpecification"/>
	</rule>
  <!-- "declare" structure -->
  <rule ref="SlevomatCodingStandard.TypeHints.DeclareStrictTypes">
		<properties>
			<property name="declareOnFirstLine" value="false"/>
      <property name="newlinesCountBetweenOpenTagAndDeclare" value="2"/>
      <property name="spacesCountAroundEqualsSign" value="0"/>
		</properties>
	</rule>
  <rule ref="SlevomatCodingStandard.Classes"/>
  <rule ref="SlevomatCodingStandard.Classes.EmptyLinesAroundClassBraces">
		<properties>
			<property name="linesCountAfterOpeningBrace" value="0"/>
      <property name="linesCountBeforeClosingBrace" value="0"/>
		</properties>
  </rule>
  <rule ref="SlevomatCodingStandard.ControlStructures.EarlyExit"/>
  <rule ref="SlevomatCodingStandard.ControlStructures.NewWithParentheses"/>
  <rule ref="SlevomatCodingStandard.ControlStructures.UselessIfConditionWithReturn"/>
  <!-- # Clean code -->
  <rule ref="SlevomatCodingStandard.Namespaces.UseFromSameNamespace"/>
  <rule ref="SlevomatCodingStandard.Namespaces.UselessAlias"/>
  <rule ref="SlevomatCodingStandard.Namespaces.UnusedUses"/>
  <rule ref="SlevomatCodingStandard.Functions.UnusedInheritedVariablePassedToClosure"/>
  <rule ref="SlevomatCodingStandard.Functions.UnusedParameter"/>
  <rule ref="SlevomatCodingStandard.Functions.UselessParameterDefaultValue"/>
  <rule ref="SlevomatCodingStandard.PHP"/>
  <!-- # Formatting -->
  <rule ref="SlevomatCodingStandard.Arrays.TrailingArrayComma"/>
  <rule ref="SlevomatCodingStandard.Commenting.UselessFunctionDocComment"/>
  <rule ref="Squiz.Strings.ConcatenationSpacing">
    <properties>
      <property name="spacing" value="1"/>
      <property name="ignoreNewlines" value="true"/>
    </properties>
  </rule>

  <!-- exclude vendors -->
  <exclude-pattern>*/node_modules/*</exclude-pattern>
  <exclude-pattern>*/vendor/*</exclude-pattern>
</ruleset>
